Flow:

1. User types in a request in the chat window. (user_request)
2. Agent creates an initial plan and presents it back to the user.
3. User view the plan, adjusts it if needed, and submits for execution.
4. Agent runs the execution loop
  4.1 Agent updates the UI with the plan status/updates. type="plan"
  4.2 Agent sends intermediate artifacts to the UI. type="artifact". These are usually rendered 
      in the Chat window.
  4.3 Agent sends the final findings to the UI. type="findings". These are usually rendered 
      in the Report window.
5. User can stop the execution loop. type="stop"
6. User can send a new request. - stops any current execution
7. User can send a new plan. - stops any current execution

Communication
- websockets
- UI only sends user_request (see schema)
- Agent only sends agent_response, streams these responses in chunks with headers.
- Format is JSON

Schema

Requests:

request_types = ["request","plan_confirmation","stop"]

user_request = 
{
  "session_id":"AWEFAWEF#$#@$#@$",
  "type":"request",
  "role":"user",
  "content":"Write me a report on the Australian economy showing the money supply and the CPI over time"
}

user_request = 
{
  "type":"plan_confirmation",
  "role":"user",
  "content":".....Full content of the plan......"
}

Responses:

response_types = ["plan","artifact","findings"]
content_types = ["md","jsx","image/png","image/jpg","csv","text"]

agent_response = 
{
  "type":"plan",
  "content/type":"md",
  "role":"assistant",
  "content":"content",
  "command":""
}

example:

{
  "type":"plan",
  "content/type":"md",
  "role":"assistant"
  "content":"1. Search the"  
}
{
  "type":"plan",
  "content/type":"md",
  "role":"assistant"
  "content":"web for economic data about Australia. 2) tell"  
}
......
{
  "type":"plan",
  "content/type":"md",
  "role":"assistant"
  "content":""
}
{
  "type":"plan",
  "content/type":"md",
  "role":"assistant"
  "content":""
  "command":"stop"
}

Types of responses:

{
    "type": "plan",
    "content": plan_markdown,
    "content_type":"md"
}

{
    "type": "findings",
    "content": findings_markdown,
    "content_type":"md"
}

{
    "type": "done",
    "content": final_answer,
    "content_type":"text"
}

